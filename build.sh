#!/bin/bash

# ุณูุฑูุจุช ุจูุงุก ุชุทุจูู ูุงุดู ุงูุฅูุจุงู

echo "==================================="
echo "   ุจูุงุก ุชุทุจูู ูุงุดู ุงูุฅูุจุงู"
echo "==================================="
echo ""

# ุงูุชุญูู ูู ูุฌูุฏ gradlew
if [ ! -f "./gradlew" ]; then
    echo "โ ููู gradlew ุบูุฑ ููุฌูุฏ!"
    echo "๐ ุชุฃูุฏ ูู ุฃูู ูู ูุฌูุฏ ุงููุดุฑูุน ุงูุตุญูุญ"
    exit 1
fi

# ุฅุนุทุงุก ุตูุงุญูุงุช ุงูุชูููุฐ ูู gradlew
chmod +x ./gradlew

echo "๐จ ุจุฏุก ุนูููุฉ ุงูุจูุงุก..."
echo ""

# ุชูุธูู ุงูุจูุงุก ุงูุณุงุจู
echo "๐งน ุชูุธูู ุงูุจูุงุก ุงูุณุงุจู..."
./gradlew clean

# ุจูุงุก APK ููุชุทููุฑ (Debug)
echo ""
echo "๐ฆ ุจูุงุก APK ููุชุทููุฑ..."
./gradlew assembleDebug

# ุงูุชุญูู ูู ูุฌุงุญ ุงูุจูุงุก
if [ $? -eq 0 ]; then
    echo ""
    echo "โ ุชู ุจูุงุก ุงูุชุทุจูู ุจูุฌุงุญ!"
    echo ""
    echo "๐ ูููุน ููู APK:"
    echo "   app/build/outputs/apk/debug/app-debug.apk"
    echo ""
    echo "๐ฑ ูุชุซุจูุช ุงูุชุทุจูู ุนูู ูุงุชูู:"
    echo "   1. ูู ุจููู ููู APK ุฅูู ูุงุชูู"
    echo "   2. ุงูุชุญ ุงูููู ูู ูุฏูุฑ ุงููููุงุช"
    echo "   3. ุงุณูุญ ุจุชุซุจูุช ุงูุชุทุจููุงุช ูู ูุตุงุฏุฑ ุบูุฑ ูุนุฑููุฉ"
    echo "   4. ุงุถุบุท ุนูู ุชุซุจูุช"
    echo ""
    echo "๐ง ุฃู ุงุณุชุฎุฏู ADB:"
    echo "   adb install app/build/outputs/apk/debug/app-debug.apk"
    echo ""
else
    echo ""
    echo "โ ูุดู ุงูุจูุงุก!"
    echo "๐ ุชุญูู ูู ุงูุฃุฎุทุงุก ุฃุนูุงู"
    exit 1
fi

# ุณุคุงู ุนู ุจูุงุก ูุณุฎุฉ ุงูุฅุตุฏุงุฑ
echo ""
read -p "ูู ุชุฑูุฏ ุจูุงุก ูุณุฎุฉ ุงูุฅุตุฏุงุฑ (Release)? (y/n): " -n 1 -r
echo ""
if [[ $REPLY =~ ^[Yy]$ ]]; then
    echo "๐ฆ ุจูุงุก APK ููุฅุตุฏุงุฑ..."
    ./gradlew assembleRelease
    
    if [ $? -eq 0 ]; then
        echo ""
        echo "โ ุชู ุจูุงุก ูุณุฎุฉ ุงูุฅุตุฏุงุฑ ุจูุฌุงุญ!"
        echo ""
        echo "๐ ูููุน ููู APK:"
        echo "   app/build/outputs/apk/release/app-release.apk"
        echo ""
        echo "โ๏ธ  ููุงุญุธุฉ: ูุณุฎุฉ ุงูุฅุตุฏุงุฑ ุบูุฑ ูููุนุฉ. ูุฑูุนูุง ุนูู Google Play:"
        echo "   1. ูู ุจุฅูุดุงุก keystore"
        echo "   2. ููุน ุงูุชุทุจูู"
        echo "   3. ุงุณุชุฎุฏู bundleRelease ุจุฏูุงู ูู assembleRelease"
        echo ""
    fi
fi

echo "==================================="
echo "   ุชู ุงูุงูุชูุงุก!"
echo "==================================="
